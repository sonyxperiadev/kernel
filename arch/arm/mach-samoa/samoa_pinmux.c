/************************************************************************************************/
/*                                                                                              */
/*  Copyright 2010  Broadcom Corporation                                                        */
/*                                                                                              */
/*     Unless you and Broadcom execute a separate written software license agreement governing  */
/*     use of this software, this software is licensed to you under the terms of the GNU        */
/*     General Public License version 2 (the GPL), available at                                 */
/*                                                                                              */
/*          http://www.broadcom.com/licenses/GPLv2.php                                          */
/*                                                                                              */
/*     with the following added to such license:                                                */
/*                                                                                              */
/*     As a special exception, the copyright holders of this software give you permission to    */
/*     link this software with independent modules, and to copy and distribute the resulting    */
/*     executable under terms of your choice, provided that you also meet, for each linked      */
/*     independent module, the terms and conditions of the license of that module.              */
/*     An independent module is a module which is not derived from this software.  The special  */
/*     exception does not apply to any modifications of the software.                           */
/*                                                                                              */
/*     Notwithstanding the above, under no circumstances may you combine this software in any   */
/*     way with any other Broadcom software provided under a license other than the GPL,        */
/*     without Broadcom's express prior written consent.                                        */
/*                                                                                              */
/************************************************************************************************/
#include <linux/kernel.h>
#include <linux/init.h>

#include <mach/pinmux.h>
#include <mach/rdb/brcm_rdb_sysmap.h>
#include <mach/rdb/brcm_rdb_padctrlreg.h>

#define	PIN_DESC(ball, alt1, alt2, alt3, alt4, alt5, alt6)	 	\
	[PN_##ball] = {							\
		.name		=	PN_##ball,			\
		.reg_offset	=	PADCTRLREG_##ball##_OFFSET,	\
		.f_tbl		=	{				\
			PF_##alt1, PF_##alt2, PF_##alt3, 		\
			PF_##alt4, PF_##alt5, PF_##alt6, 		\
		},							\
	}


#if 0 /* FIXME */ 
/*
 * Rhea chip-level pin description table
 *  generated from
 *     http://mpg-twiki.broadcom.com/bin/view/Projects/RheaPinmux
 */
static const struct pin_desc pin_desc_tbl[PN_MAX] = {
	PIN_DESC(LCDCS0, LCDSCS0, LCDCS2, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(LCDSCL, LCDSCL, LCDCD, RESERVED, RESERVED, GPIO, MPHI_HA0),
	PIN_DESC(LCDSDA, LCDSDA, LCDD0, RESERVED, RESERVED, GPIO, MPHI_DATA0),
	PIN_DESC(LCDRES, RESERVED, RESERVED, RESERVED, RESERVED, GPIO, MPHI_RUN),
	PIN_DESC(LCDTE, LCDTE, LCDTE, RESERVED, RESERVED, GPIO, MPHI_HAT0),
	PIN_DESC(CAMCS0, ANA_SYS_REQ1, MMCX_GPO, LCDD16, RESERVED, GPIO, AP_RSTN),
	PIN_DESC(CAMCS1, SIM2LDO_EN, ANA_SYS_REQ2, LCDD17, CLK_MON, GPIO, AP_DAC_DATA_I),
	PIN_DESC(UBRX, UBRX, RESERVED, PWM4, DCLK4, GPIO, RESERVED),
	PIN_DESC(UBTX, UBTX, RESERVED, PWM5, DCLKREQ4, GPIO, RESERVED),
	PIN_DESC(UBRTSN, UBRTSN, RESERVED, RXD, BSC2CLK_THP, GPIO, OSC1_OUT),
	PIN_DESC(UBCTSN, UBCTSN, RXD, RESERVED, BSC2DAT_THP, GPIO, OSC2_OUT),
	PIN_DESC(PMBSCCLK, PMBSCCLK, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(PMBSCDAT, PMBSCDAT, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(BSC1CLK, BSC1CLK, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(BSC1DAT, BSC1DAT, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(SIMRST, SIMRST, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(SIMDAT, SIMDAT, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(SIMCLK, SIMCLK, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(SIMDET, SIMDET, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC0CK, MMC0CK, SSP2CK, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC0CMD, MMC0CMD, SSP2DO, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC0RST, MMC0RST, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC0DAT7, MMC0DAT7, SYSCLKREQA, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC0DAT6, MMC0DAT6, SYSCLKREQB, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC0DAT5, MMC0DAT5, DCLK2, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC0DAT4, MMC0DAT4, DCLK3, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC0DAT3, MMC0DAT3, SSP2SYN, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC0DAT2, MMC0DAT2, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC0DAT1, MMC0DAT1, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC0DAT0, MMC0DAT0, SSP2DI, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC1CK, MMC1CK, PTI_CLK, RESERVED, PWM5, GPIO, RESERVED),
	PIN_DESC(MMC1CMD, MMC1CMD, RXD, RESERVED, PWM4, GPIO, RESERVED),
	PIN_DESC(MMC1RST, MMC1RST, RESERVED, RESERVED, PWM3, GPIO, RESERVED),
	PIN_DESC(MMC1DAT7, MMC1DAT7, SIM2LDO_EN, SSP2CK, ANA_SYS_REQ3, GPIO, RESERVED),
	PIN_DESC(MMC1DAT6, MMC1DAT6, SLEEPCLKTST, SSP2DO, ANA_SYS_REQ3, GPIO, AP_IHF_DATA_I),
	PIN_DESC(MMC1DAT5, MMC1DAT5, PWM4, SSP2DI, ANA_SYS_REQ1, GPIO, RESERVED),
	PIN_DESC(MMC1DAT4, MMC1DAT4, PWM3, SSP2SYN, ANA_SYS_REQ2, GPIO, RESERVED),
	PIN_DESC(MMC1DAT3, MMC1DAT3, PTI_DAT3, PWM2, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC1DAT2, MMC1DAT2, PTI_DAT2, PWM1, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC1DAT1, MMC1DAT1, PTI_DAT1, PWM0, RESERVED, GPIO, RESERVED),
	PIN_DESC(MMC1DAT0, MMC1DAT0, PTI_DAT0, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(SDCK, SDCK, PTI_CLK, RESERVED, SSP1CK, GPIO, U1TXD),
	PIN_DESC(SDCMD, SDCMD, RXD, RESERVED, SSP1DO, GPIO, U1RXD),
	PIN_DESC(SDDAT3, SDDAT3, PTI_DAT3, RESERVED, SWCLKTCK, GPIO, PM_DEBUG3),
	PIN_DESC(SDDAT2, SDDAT2, PTI_DAT2, RESERVED, SWDIOTMS, GPIO, PM_DEBUG2),
	PIN_DESC(SDDAT1, SDDAT1, PTI_DAT1, RESERVED, SSP1SYN, GPIO, PM_DEBUG1),
	PIN_DESC(SDDAT0, SDDAT0, PTI_DAT0, RESERVED, SSP1DI, GPIO, PM_DEBUG0),
	PIN_DESC(SSPSYN, SSP2SYN, DMIC1DQ, SIM2RST, PWM0, GPIO, RESERVED),
	PIN_DESC(SSPDO, SSP2DO, RXD, SIM2DAT, PWM1, GPIO, RESERVED),
	PIN_DESC(SSPCK, SSP2CK, DMIC1CLK, SIM2CLK, PWM2, GPIO, RESERVED),
	PIN_DESC(SSPDI, SSP2DI, RESERVED, SIM2DET, PWM3, GPIO, RXD),
	PIN_DESC(SPI0FSS, SSP0SYN, RESERVED, LCDSCL, SYSCLKREQA, GPIO, AP_LRCK_I),
	PIN_DESC(SPI0CLK, SSP0CK, RESERVED, LCDSDA, DCLK2, GPIO, AP_SCLK_I),
	PIN_DESC(SPI0TXD, SSP0DO, RESERVED, RESERVED, DCLK3, GPIO, AP_ADC_DATA_O),
	PIN_DESC(SPI0RXD, SSP0DI, RESERVED, LCDTE, SYSCLKREQB, GPIO, AP_REF_2P4M_CLK),
	PIN_DESC(GPIO93, RESERVED, GPEN13, SSP1CK, RESERVED, GPIO, RESERVED),
	PIN_DESC(GPIO94, RESERVED, AFCPDM, SSP1SYN, RESERVED, GPIO, RESERVED),
	PIN_DESC(DCLK4, DCLK4, RESERVED, SSP1DO, PWM4, GPIO, RESERVED),
	PIN_DESC(DCLKREQ4, DCLKREQ4, GPEN15, SSP1DI, PWM5, GPIO, RESERVED),
	PIN_DESC(GPS_TMARK, RESERVED, SYSCLKREQA, PWM0, GPEN12, GPIO, RESERVED),
	PIN_DESC(GPS_PABLANK, GPEN10, DCLK2, PWM1, RESERVED, GPIO, RESERVED),
	PIN_DESC(GPS_CALREQ, SIM2LDO_EN, DCLK3, PWM2, RTCK, GPIO, RESERVED),
	PIN_DESC(GPS_HOSTREQ, RESERVED, SYSCLKREQB, PWM3, GPEN11, GPIO, SSP1DI),
	PIN_DESC(TRACECLK, TRACECLK, PTI_CLK, RESERVED, DSPTRACECLK, GPIO, RESERVED),
	PIN_DESC(TRACEDT07, TRACEDT07, RXD, RESERVED, DSPTRACEDT7, GPIO, RESERVED),
	PIN_DESC(TRACEDT06, TRACEDT06, RESERVED, RESERVED, DSPTRACEDT6, GPIO, RESERVED),
	PIN_DESC(TRACEDT05, TRACEDT05, RESERVED, RESERVED, DSPTRACEDT5, GPIO, RESERVED),
	PIN_DESC(TRACEDT04, TRACEDT04, RESERVED, RESERVED, DSPTRACEDT4, GPIO, RESERVED),
	PIN_DESC(TRACEDT03, TRACEDT03, PTI_DAT3, RESERVED, DSPTRACEDT3, GPIO, RESERVED),
	PIN_DESC(TRACEDT02, TRACEDT02, PTI_DAT2, RESERVED, DSPTRACEDT2, GPIO, RESERVED),
	PIN_DESC(TRACEDT01, TRACEDT01, PTI_DAT1, RESERVED, DSPTRACEDT1, GPIO, RESERVED),
	PIN_DESC(TRACEDT00, TRACEDT00, PTI_DAT0, RESERVED, DSPTRACEDT0, GPIO, RESERVED),
	PIN_DESC(DCLK1, DCLK1, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(DCLKREQ1, DCLKREQ1, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(GPIO00, GPIO, KEY_R0, LCDD15, RESERVED, RESERVED, BBRF_TESTPORT00),
	PIN_DESC(GPIO01, GPIO, KEY_R1, LCDD14, RESERVED, RESERVED, BBRF_TESTPORT01),
	PIN_DESC(GPIO02, GPIO, KEY_R2, LCDD13, RESERVED, RESERVED, BBRF_TESTPORT02),
	PIN_DESC(GPIO03, GPIO, KEY_R3, LCDD12, RESERVED, RESERVED, BBRF_TESTPORT03),
	PIN_DESC(GPIO04, GPIO, KEY_R4, RESERVED, CADATA, RESERVED, BBRF_TESTPORT04),
	PIN_DESC(GPIO05, GPIO, KEY_R5, RESERVED, CAFLAG, RESERVED, BBRF_TESTPORT05),
	PIN_DESC(GPIO06, GPIO, KEY_R6, RESERVED, CAREADY, SSP2DI, BBRF_TESTPORT06),
	PIN_DESC(GPIO07, GPIO, KEY_R7, RESERVED, CAWAKE, SSP2DO, BBRF_TESTPORT07),
	PIN_DESC(GPIO08, GPIO, KEY_C0, LCDD11, PWM0, RESERVED, BBRF_TESTPORT08),
	PIN_DESC(GPIO09, GPIO, KEY_C1, LCDD10, PWM1, RESERVED, BBRF_TESTPORT09),
	PIN_DESC(GPIO10, GPIO, KEY_C2, LCDD9, PWM2, RESERVED, BBRF_TESTPORT10),
	PIN_DESC(GPIO11, GPIO, KEY_C3, LCDD8, RESERVED, RESERVED, BBRF_TESTPORT11),
	PIN_DESC(GPIO12, GPIO, KEY_C4, RESERVED, ACDATA, RESERVED, BBRF_TESTPORT12),
	PIN_DESC(GPIO13, GPIO, KEY_C5, PWM3, ACFLAG, RESERVED, BBRF_TESTPORT13),
	PIN_DESC(GPIO14, GPIO, KEY_C6, PWM4, ACREADY, SSP2CK, BBRF_TESTPORT14),
	PIN_DESC(GPIO15, GPIO, KEY_C7, PWM5, ACWAKE, SSP2SYN, BBRF_TESTPORT15),
	PIN_DESC(GPIO16, GPIO, BSC2CLK, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(GPIO17, GPIO, BSC2DAT, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(GPIO18, GPIO, LCDCS1, UB2TX, RESERVED, GPEN09, MPHI_HCE0_N),
	PIN_DESC(GPIO19, GPIO, LCDWE, UB2RX, RESERVED, GPEN10, MPHI_HWR_N),
	PIN_DESC(GPIO20, GPIO, LCDRE, UB2RTSN, RESERVED, GPEN11, MPHI_HRD_N),
	PIN_DESC(GPIO21, GPIO, LCDD7, UB2CTSN, CADATA, GPEN12, MPHI_DATA7),
	PIN_DESC(GPIO22, GPIO, LCDD6, PWM0, CAFLAG, RESERVED, MPHI_DATA6),
	PIN_DESC(GPIO23, GPIO, LCDD5, PWM1, CAREADY, RESERVED, MPHI_DATA5),
	PIN_DESC(GPIO24, GPIO, LCDD4, PWM2, CAWAKE, RESERVED, MPHI_DATA4),
	PIN_DESC(GPIO25, GPIO, LCDD3, PWM3, ACDATA, RESERVED, MPHI_DATA3),
	PIN_DESC(GPIO26, GPIO, LCDD2, RESERVED, ACFLAG, GPEN13, MPHI_DATA2),
	PIN_DESC(GPIO27, GPIO, LCDD1, RESERVED, ACREADY, RESERVED, MPHI_DATA1),
	PIN_DESC(GPIO28, GPIO, DSI1TE, RESERVED, ACWAKE, GPEN15, RESERVED),
	PIN_DESC(PMUINT, GPIO, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(BATRM, BATRM, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(STAT1, STAT1, SIMLDO_EN, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(GPIO32, GPIO, RESERVED, SSP1CK, DCLK2, RESERVED, RESERVED),
	PIN_DESC(GPIO33, GPIO, RESERVED, SSP1SYN, SYSCLKREQA, DMIC1CLK, RESERVED),
	PIN_DESC(GPIO34, GPIO, RESERVED, SSP1DO, DCLK3, DMIC1DQ, RESERVED),
	PIN_DESC(STAT2, STAT2, CLASSABPWR, RESERVED, SYSCLKREQB, GPIO, RESERVED),
	PIN_DESC(ADCSYN, GPEN09, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(DSI0TE, GPIO, RESERVED, RESERVED, RESERVED, DSI0TE, RESERVED),
	PIN_DESC(MDMGPIO00, RESERVED, RESERVED, GPEN00, RESERVED, GPIO, RESERVED),
	PIN_DESC(MDMGPIO01, RESERVED, RESERVED, GPEN01, RESERVED, GPIO, RESERVED),
	PIN_DESC(MDMGPIO02, RESERVED, RESERVED, GPEN02, RESERVED, GPIO, RESERVED),
	PIN_DESC(MDMGPIO03, RESERVED, RESERVED, GPEN14, RESERVED, GPIO, RESERVED),
	PIN_DESC(MDMGPIO04, RESERVED, RESERVED, GPEN04, RESERVED, GPIO, RESERVED),
	PIN_DESC(MDMGPIO05, RESERVED, RESERVED, GPEN05, RESERVED, GPIO, RESERVED),
	PIN_DESC(MDMGPIO06, RESERVED, RESERVED, GPEN06, RESERVED, GPIO, RESERVED),
	PIN_DESC(MDMGPIO07, RESERVED, RESERVED, GPEN07, RESERVED, GPIO, RESERVED),
	PIN_DESC(MDMGPIO08, RESERVED, RESERVED, GPEN08, RESERVED, GPIO, RESERVED),
	PIN_DESC(TESTMODE, TESTMODE, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(RESETN, RESETN, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(CLK32K, CLK32K, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(PC1, PC1, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(PC2, PC2, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(TDO, TDO, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(TDI, TDI, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(SWDIOTMS, SWDIOTMS, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(TRSTB, TRSTB, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(SWCLKTCK, SWCLKTCK, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(ICUSBDP, USBDP, RESERVED, RXD, AFCPDM, GPIO, RESERVED),
	PIN_DESC(ICUSBDM, USBDM, RXD, RESERVED, GPEN11, GPIO, RESERVED),
	PIN_DESC(DMIC0CLK, DMIC0CLK, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(DMIC0DQ, DMIC0DQ, RESERVED, RESERVED, RESERVED, GPIO, RESERVED),
	PIN_DESC(SRI_C, SRI_C, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(SRI_E, SRI_E, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(SRI_D, SRI_D, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(RFST2G_MTSLOTEN3G, GPEN03, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(TXDATA3G0, TXDATA3G0, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(RTXDATA2G_TXDATA3G1, RTXDATA2G_TXDATA3G1, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(RTXEN2G_TXDATA3G2, RTXEN2G_TXDATA3G2, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(RXDATA3G0, RXDATA3G0, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(RXDATA3G1, RXDATA3G1, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(RXDATA3G2, RXDATA3G2, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(CLK_CX8, CLK_CX8, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
	PIN_DESC(SYSCLKEN, SYSCLKEN, RESERVED, RESERVED, RESERVED, RESERVED, RESERVED),
};

#endif

struct chip_pin_desc g_chip_pin_desc = {
#if 0 /* FIXME */ 
	.desc_tbl	=	pin_desc_tbl,
#endif
};

#if 0
/* unlock access lock */
static void __init rhea_unlock_padctl (void __iomem *base)
{
#define PASSWORD 0xA5A501
	writel(PASSWORD, base + PADCTRLREG_WR_ACCESS_OFFSET);
	writel(0x0, base + PADCTRLREG_ACCESS_LOCK0_OFFSET);

	writel(PASSWORD, base + PADCTRLREG_WR_ACCESS_OFFSET);
	writel(0x0, base + PADCTRLREG_ACCESS_LOCK1_OFFSET);

	writel(PASSWORD, base + PADCTRLREG_WR_ACCESS_OFFSET);
	writel(0x0, base + PADCTRLREG_ACCESS_LOCK2_OFFSET);

	writel(PASSWORD, base + PADCTRLREG_WR_ACCESS_OFFSET);
	writel(0x0, base + PADCTRLREG_ACCESS_LOCK3_OFFSET);

	writel(PASSWORD, base + PADCTRLREG_WR_ACCESS_OFFSET);
	writel(0x0, base + PADCTRLREG_ACCESS_LOCK4_OFFSET);
}
#endif


int __init pinmux_chip_init (void)
{
#if 0 /* FIXME */ 
	g_chip_pin_desc.base = ioremap(PAD_CTRL_BASE_ADDR, SZ_2K);
	BUG_ON (!g_chip_pin_desc.base);

	rhea_unlock_padctl(g_chip_pin_desc.base);
#endif	
	return 0;
}

